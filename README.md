### –ü–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞ –∫ –ø—Ä–æ–µ–∫—Ç—É MQTT –∏–∑–¥–∞—Ç–µ–ª—è –∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞
![](https://github.com/f0lp1x/lab7/blob/master/6rr1YZFPJ2Y.jpg)


#### **–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞**
–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è MQTT-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –∏–∑–¥–∞—Ç–µ–ª—è –∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö.
- –ü—Ä–∏–Ω–∏–º–∞—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

–î–ª—è —ç—Ç–æ–≥–æ –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥ –∏–∑–¥–∞—Ç–µ–ª—è, –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –∏ –ª–æ–≥–∏–∫–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

---
–ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∏, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ C#, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫—É **MQTTnet** –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª MQTT. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –µ–≥–æ –ø–æ —á–∞—Å—Ç—è–º.

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑–¥–∞—Ç–µ–ª—è (Publisher)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **–ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫**: –ö–æ–¥ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∏–º–ø–æ—Ä—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω, –≤–∫–ª—é—á–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

2. **–ö–ª–∞—Å—Å Program**: –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ `Main`, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É.

3. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤**:
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ `ServiceCollection`, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
   - –î–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫—ç—à –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞.

4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
   - –ú–µ—Ç–æ–¥ `InitConfiguration` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ `appsettings.json`.
   - –ü–æ–ª—É—á–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MQTT –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

5. **–ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π**:
   - –ú–µ—Ç–æ–¥ `StartPublishAsync` –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –Ω–∞ –∑–∞–¥–∞–Ω–Ω—É—é —Ç–µ–º—É —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç `mqttSender`.

### –í–∞–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã

- **`Main`**:
  - –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä `ServiceProvider`, –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∫—ç—à –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.
  - –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç `Mqtt` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.

- **`StartPublishAsync`**:
  - –¶–∏–∫–ª, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ MQTT.

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ (Subscriber)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **–ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫**: –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –∏–∑–¥–∞—Ç–µ–ª—è, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ –∂–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

2. **–ö–ª–∞—Å—Å Program**: –°–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–æ–¥ `Main`, –∫–æ—Ç–æ—Ä—ã–π —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞.

3. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤**:
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏–∑–¥–∞—Ç–µ–ª—é.
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç `Mqtt`.

4. **–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è**:
   - –ú–µ—Ç–æ–¥ `SubscribeAsync` –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞ –∑–∞–¥–∞–Ω–Ω—É—é —Ç–µ–º—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É—Ä–æ–≤–Ω—è –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è (QoS).
   - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π (`Handler`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—ã—Ç–∞—è—Å—å –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏—Ö –∫–∞–∫ JSON –∏–ª–∏ –≤—ã–≤–æ–¥—è —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.

### –í–∞–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã

- **`Main`**:
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ MQTT.
  - –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –æ–∂–∏–¥–∞–µ—Ç –∏—Ö –ø–æ–ª—É—á–µ–Ω–∏—è.

- **`Handler`**:
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –≤—ã–≤–æ–¥—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ª–æ–≥ –æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞ (JSON –∏–ª–∏ —Ç–µ–∫—Å—Ç).

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û–±–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ–¥—Ö–æ–¥ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π. –ò–∑–¥–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –∑–∞–¥–∞–Ω–Ω—É—é —Ç–µ–º—É, –∞ –ø–æ–¥–ø–∏—Å—á–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Ö. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MQTT –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ IoT (–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–µ—â–µ–π).

![](https://github.com/sorrymorning/MQTTLAB/blob/testCoding/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202024-12-07%20003407.png)

# –ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—É–ø–µ—Ä –º–∏–ª—ã—Ö —Å–º–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–Ω–∏–º—É—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:

- üòä (—É–ª—ã–±–∞—é—â–µ–µ—Å—è –ª–∏—Ü–æ —Å —É–ª—ã–±–∫–æ–π)
- ü•∞ (–ª–∏—Ü–æ —Å —Å–µ—Ä–¥–µ—á–∫–∞–º–∏)
- üòª (–∫–æ—Ç —Å —Å–µ—Ä–¥–µ—á–∫–∞–º–∏ –≤ –≥–ª–∞–∑–∞—Ö)
- üå∏ (—Ü–≤–µ—Ç–æ–∫)
- üêæ (–ø—è—Ç–Ω–∞ –ª–∞–ø)
- üåà (—Ä–∞–¥—É–≥–∞)
- ü¶Ñ (–µ–¥–∏–Ω–æ—Ä–æ–≥)
- ü•≥ (–ª–∏—Ü–æ —Å –≤–µ—á–µ—Ä–∏–Ω–∫–æ–π)
- üçÄ (—á–µ—Ç—ã—Ä–µ—Ö–ª–∏—Å—Ç–Ω—ã–π –∫–ª–µ–≤–µ—Ä)
- üíñ (–±–ª–µ—Å—Ç—è—â–µ–µ —Å–µ—Ä–¥—Ü–µ)



#
